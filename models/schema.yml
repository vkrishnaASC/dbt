version: 2

models:
  - name: fact_customer_revenue
    description: "Gold layer: Final customer revenue metrics."
    tests:
      - unique:
          column_name: customer_id
      - not_null:
          column_name: customer_id
      - not_null:
          column_name: total_revenue
      - dbt_utils.expression_is_true:
          expression: "revenue_amount >= 0"
          description: "Ensures revenue amounts are not negative"
    columns:
      - name: customer_id
        description: "Unique identifier for each customer"
        tests:
          - not_null
      - name: total_revenue
        description: "Total revenue generated by the customer"
        tests:
          - statistical_range:
              min_value: 0
              max_value: 1000000