version: 2

unit_tests:
  - name: test_total_amount_calculation
    model: silver_orders
    given:
      - input: ref('bronze_orders')
        rows:
          - {order_id: 10, customer_id: 201, order_date: '2024-01-10', status: 'COMPLETED', quantity: 2, unit_price: 100}
    expect:
      rows:
        - {order_id: 10, total_amount: 200}
