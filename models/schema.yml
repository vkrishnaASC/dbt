version: 2

models:
  - name: fact_customer_revenue
    description: "Gold layer: Final customer revenue metrics."
    tests:
      - unique:
          column_name: customer_id
      - not_null:
          column_name: customer_id  # Combined with column-level test
      - dbt_utils.expression_is_true:
          expression: "total_revenue >= 0"  # Simplified from revenue_amount
          description: "Ensures revenue amounts are not negative"
    columns:
      - name: customer_id
        description: "Unique identifier for each customer"
      - name: total_revenue
        description: "Total revenue generated by the customer"
        tests:
          - not_null
          - range:  # Using built-in range test instead of statistical_range
              min_value: 0
              max_value: 100000